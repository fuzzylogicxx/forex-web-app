<div class="container">

  <%= form_with model: @rate, method: :get, local: true, class: "form-custom form-rates-base", id: "form-rates-base" do |f| %>
    <div class="form-group">
      <%= label_tag(:amount, "Enter a base value") %>
      <%= number_field_tag :amount, (params[:amount] or 100), required: true %>
    </div>
    <%= submit_tag 'Convert', name: nil %>
  <% end %>

  <% if @rates %>
  
  <h2>Latest Rates</h2>
  <p class="note">Select any two currency rows to launch our 5-day comparison tool.</p>

  <div class="table-container" id="latest-rates-table-container">
  <table id="latest-rates-table">
    <thead>
      <tr>
        <th>Currency</th>
        <th>Amount</th>
      </tr>
    </thead>
    <tbody>
      <% @rates['rates'].each do |key, value| %>
        <tr data-currency="<%= key.to_s %>">
          <td><%=h "#{key.to_s}" %></td>
          <td><%= '%.2f' % (value.to_f * (params[:amount] or 100).to_f) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

</div> <!-- /.container -->

<script>
// Save today’s rates to a JS object 
// so later we need only fetch previous days’ rates.
const ratesToday = <%= raw(@rates['rates'].to_json) %>;
</script>

<!-- Modal is hidden by default, so no negative impact on those using assistive technology -->
<div class="modal-overlay closed" id="modal-overlay"></div>
<div class="modal closed" id="modal">
<button class="close-button" id="close-button">Close</button>
<div class="modal-body" id="modal-body"></div>
</div>

<% else %>  
      
<p>Sorry, we encountered a problem while trying to fetch the latest exchange rates. Please try again later.</p>

</div> <!-- /.container -->

<% end %>